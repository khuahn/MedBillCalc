<!DOCTYPE html>
<html>
<head>
    <title>Firebase Test - MedBillCalc</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; }
        input, button { padding: 8px; margin: 5px; }
        #result { margin-top: 15px; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h2>üî• Firebase Login Tracking Test</h2>
    <p>This is a safe test page - won't affect main calculator!</p>
    
    <input type="text" id="initials" placeholder="Enter initials">
    <input type="text" id="purpose" placeholder="Purpose">
    <button onclick="testLogin()">Test Login Tracking</button>
    
    <div id="result"></div>

    <script>
        // TEST MODE - No real Firebase config yet
        const firebaseConfig = {
            apiKey: "TEST_MODE_NOT_CONFIGURED_YET",
            authDomain: "test-mode.firebaseapp.com",
            projectId: "test-mode",
            storageBucket: "test-mode.appspot.com",
            messagingSenderId: "123456789",
            appId: "test-mode-app-id"
        };
        
        // Initialize Firebase (will fail safely until configured)
        let db = null;
        try {
            const app = firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
        } catch (error) {
            console.log("Firebase not configured yet - test mode");
        }

        async function testLogin() {
            const initials = document.getElementById('initials').value;
            const purpose = document.getElementById('purpose').value;
            const resultDiv = document.getElementById('result');
            
            if (!db) {
                resultDiv.className = 'error';
                resultDiv.innerHTML = '‚ùå Firebase not configured<br><small>This is expected during testing</small>';
                return;
            }
            
            try {
                await db.collection('loginHistory').add({
                    timestamp: new Date(),
                    initials: initials,
                    purpose: purpose,
                    userAgent: navigator.userAgent,
                    testMode: true
                });
                resultDiv.className = 'success';
                resultDiv.textContent = "‚úÖ Login logged successfully!";
            } catch (error) {
                resultDiv.className = 'error';
                resultDiv.innerHTML = "‚ùå Error: " + error.message + "<br><small>We'll fix this together</small>";
            }
        }
    </script>
</body>
</html>
